{% extends 'base.html' %}

{% load bootstrap3 %}

{% load django_bootstrap_breadcrumbs %}

{% block breadcrumbs %}
    {{ block.super }}

    {% breadcrumb "Projects" "ids_projects:project-list" %}

    {% if project.short %}
        {% breadcrumb project.short "ids_projects:project-view" project.uuid %}
    {% else %}
        {% breadcrumb "Project" "ids_projects:project-view" project.uuid %}
    {% endif %}

{% endblock %}

{% block title %}Projects{% endblock %}

{% block content %}
<div class="container">

    <div class="row">
        <div class="col-xs-10 col-xs-offset-1 col-sm-offset-0 col-sm-12">
            {% render_breadcrumbs 'django_bootstrap_breadcrumbs/bootstrap3.html' %}
        </div>
    </div>
    <div class="row">
        <!-- Left Column - Project Basic Info -->
        <div class="col-xs-10 col-xs-offset-1 col-sm-offset-0 col-sm-5">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h1 class="panel-title">Project</h1>
                </div>
                <div class="panel-body">
                    <p><img class="img-responsive" src="/static/images/img2.jpg"></p>
                    <p><b>Project Name: </b> {{ project.value.title }}</p>
                    <p><b>Investigation Type: </b> {{ project.value.investigation_type }}</p>
                    <p><b>Description: </b> {{ project.value.description }}</p>
                    <div class="row">
                        <div class="col-xs-3">
                            <a href="{% url 'ids_projects:project-edit' project_uuid=project.uuid %}" class="btn btn-primary">Edit Project</a>
                        </div>
                        <div class="col-xs-3 col-xs-offset-4 col-sm-offset-3 col-md-offset-4">
                            <a href="{% url 'ids_projects:project-delete' project_uuid=project.uuid %}" class="btn btn-danger">Delete Project</a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-xs-6">
                    <h4>Specimens: {{ specimen_count }}</h4>
                </div>
                <div class="col-xs-3 col-xs-offset-2">
                    <a href="{% url 'ids_projects:specimen-create' %}?project_uuid={{project.uuid}}" class="btn btn-primary">Add </a>
                </div>
            </div><hr>
            <div class="row">
                <div class="col-xs-6">
                    <h4>Processes: {{ process_count }}</h4>
                </div>
                <div class="col-xs-3 col-xs-offset-2">
                    <a href="{% url 'ids_projects:process-create' %}?project_uuid={{project.uuid}}" class="btn btn-primary">Add </a>
                </div>
            </div><hr>
            <div class="row">
                <div class="col-xs-6">
                    <h4>Files: {{ file_count }}</h4>
                </div>
                <div class="col-xs-3 col-xs-offset-2">
                    <!-- TODO: adding data to project, not process -->
                    {# <a href="{% url 'ids_projects:file-select' %}?project_uuid={{project.uuid}}" class="btn btn-primary">Add</a> #}
                </div>
            </div><hr>

        </div>
        <!-- Middle/Right Column - Project Basic Info -->
        <div class="col-xs-10 col-xs-offset-1 col-sm-offset-0 col-sm-7">

            <!-- <div class="panel-body"> -->
            {% if not project.specimens %}
            <div class="object-header dark">
                <div>
                    No Specimens yet.
                    <a href="{% url 'ids_projects:specimen-create' %}?project_uuid={{project.uuid}}" class="btn btn-primary btn-sm pull-right fix-me">Add</a>
                </div>
            </div>
            {% else %}
            <div class="object-header dark">
                <div>
                    Specimens
                    <a href="{% url 'ids_projects:specimen-create' %}?project_uuid={{project.uuid}}" class="btn btn-primary btn-sm pull-right fix-me">Add</a>
                </div>
            </div>

                {% for specimen in project.specimens %}

                <div class="info-panel">

                    <div class="object-header darker">
                        <a href="{% url 'ids_projects:specimen-view' specimen_uuid=specimen.uuid %}" class="header-link">{{ specimen.value.taxon_name }} {{ specimen.value.specimen_id }}</a>
                    </div>

                    <div>
                        <div class="row info-item">
                            <div class="col-xs-6">
                                <b>Taxon Name</b>
                            </div>
                            <div class="col-xs-6">
                                {{ specimen.value.taxon_name }}
                            </div>
                        </div>
                        <div class="row info-item">
                            <div class="col-xs-6">
                                <b>Specimen ID</b>
                            </div>
                            <div class="col-xs-6">
                                {{ specimen.value.specimen_id }}
                            </div>
                        </div>
                        <div class="row info-item">
                            <div class="col-xs-6">
                                <b>Organ/Tissue</b>
                            </div>
                            <div class="col-xs-6">
                                {{ specimen.value.organ_or_tissue }}
                            </div>
                        </div>
                        <div class="row info-item">
                            <div class="col-xs-6">
                                <b>Developmental Stage</b>
                            </div>
                            <div class="col-xs-6">
                                {{ specimen.value.developmental_stage }}
                            </div>
                        </div>
                        <div class="row info-item">
                            <div class="col-xs-6">
                                <b>Haploid Chromosone Count</b>
                            </div>
                            <div class="col-xs-6">
                                {{ specimen.value.haploid_chromosome_count }}
                            </div>
                        </div>
                        <div class="row info-item">
                            <div class="col-xs-6">
                                <b>Ploidy</b>
                            </div>
                            <div class="col-xs-6">
                                {{ specimen.value.ploidy }}
                            </div>
                        </div>
                        <div class="row info-item">
                            <div class="col-xs-6">
                                <b>Propagation</b>
                            </div>
                            <div class="col-xs-6">
                                {{ specimen.value.propagation }}
                            </div>
                        </div>
                        <div class="row info-item">
                            <div class="col-xs-6">
                                <b>Estimated Genome Size</b>
                            </div>
                            <div class="col-xs-6">
                                {{ specimen.value.estimated_genome_size }}
                            </div>
                        </div>

                            {% if not specimen.value.processes %}
                            <div class="object-header dark">
                                <div>
                                    {% if specimen.short %}
                                        No processes for {{ specimen.short }}
                                    {% else %}
                                        No processes for {{ specimen.value.taxon_name }} {{ specimen.value.specimen_id }}
                                    {% endif %}
                                    <a href="{% url 'ids_projects:process-create' %}?specimen_uuid={{specimen.uuid}}" class="btn btn-primary btn-sm pull-right fix-me">Add</a>
                                </div>
                            </div>
                            {% else %}
                            <div class="object-header dark">
                                <div>
                                    {% if specimen.short %}
                                        Processes for {{ specimen.short }}
                                    {% else %}
                                        Processes for {{ specimen.value.taxon_name }} {{ specimen.value.specimen_id }}
                                    {% endif %}
                                    <a href="{% url 'ids_projects:process-create' %}?specimen_uuid={{specimen.uuid}}" class="btn btn-primary btn-sm pull-right fix-me">Add</a>
                                </div>
                            </div>

                                <!-- TODO: fix this -->
                                <br>

                                {% for process in specimen.processes %}

                                <div class="object-header">
                                    <a href="{% url 'ids_projects:process-view' process_uuid=process.uuid %}" class="header-link">{{ process.process_type }}</a>
                                </div>

                                <div class="row info-item">
                                    <div class="col-xs-6">
                                        <b>Process Type</b>
                                    </div>
                                    <div class="col-xs-6">
                                        {{ process.value.process_type }}
                                    </div>
                                </div>
                                {% if process.value.sequence_method %}
                                <div class="row info-item">
                                    <div class="col-xs-6">
                                        <b>Sequence Method</b>
                                    </div>
                                    <div class="col-xs-6">
                                        {{ process.value.sequence_method }}
                                    </div>
                                </div>
                                {% endif %}
                                {% if process.value.sequence_hardware %}
                                <div class="row info-item">
                                    <div class="col-xs-6">
                                        <b>Sequence Hardware</b>
                                    </div>
                                    <div class="col-xs-6">
                                        {{ process.value.sequence_hardware }}
                                    </div>
                                </div>
                                {% endif %}
                                {% if process.value.assembly_method %}
                                <div class="row info-item">
                                    <div class="col-xs-6">
                                        <b>Assembly Method</b>
                                    </div>
                                    <div class="col-xs-6">
                                        {{ process.value.assembly_method }}
                                    </div>
                                </div>
                                {% endif %}
                                {% if process.value.reference_sequence %}
                                <div class="row info-item">
                                    <div class="col-xs-6">
                                        <b>Reference Sequence</b>
                                    </div>
                                    <div class="col-xs-6">
                                        {{ process.value.reference_sequence }}
                                    </div>
                                </div>
                                {% endif %}

                                {% endfor %} <!-- processes -->
                            {% endif %} <!-- specimen.processes -->

                            </div>

                        </div>

                    <hr>

                {% endfor %} <!-- specimens -->
            {% endif %} <!-- project.specimens -->
        </div>
    </div>
</div>
{% endblock %}
